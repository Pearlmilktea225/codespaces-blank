--[[
    çå¥¶è…³æœ¬ (ZhenNai Hub) - å›ç‹è¦ºé†’ç‰ˆ v8.0
    æ–°å¢ï¼šç²’å­ç‰¹æ•ˆç³»çµ± (FX) + æˆ°é¬¥è®Šè‰²é€£å‹•
    æ ¸å¿ƒï¼šéš±å½¢ + æŒ‡å®šçµæ®º + è¦–è¦ºç‰¹æ•ˆ
]]

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = game.Workspace.CurrentCamera
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- è®Šæ•¸é…ç½®
local Config = {
    TargetName = "",
    CurrentTarget = nil,
    
    -- æˆ°é¬¥
    FlingEnabled = false,
    Aimbot = false,
    Hitbox = false, HitboxSize = 10,
    
    -- éš±å½¢
    Invisible = false,
    
    -- ç‰¹æ•ˆ (æ–°å¢)
    Aura = false,        -- éœ¸æ°£é–‹é—œ
    EyeGlow = false,     -- çœ¼ç›ç™¼å…‰
    AggroColor = true,   -- çµæ®ºæ™‚è®Šç´…
    
    -- å±¬æ€§
    Speed = 50, SpeedEnabled = false,
    InfJump = false,
    Noclip = false,
    ESP = false
}

--------------------------------------------------------------------------------
-- 0. è¼”åŠ©å‡½æ•¸
--------------------------------------------------------------------------------
local function FindPlayer(string)
    if string == "" or string == nil then return nil end
    local found = nil
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            if string.find(string.lower(p.Name), string.lower(string)) or 
               string.find(string.lower(p.DisplayName), string.lower(string)) then
                found = p
                break 
            end
        end
    end
    return found
end

-- [ç‰¹æ•ˆç®¡ç†å™¨]
local FXFolder = Instance.new("Folder", game.Workspace)
FXFolder.Name = "ZhenNaiFX"

local function AddAura(char)
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart")
    if root and not root:FindFirstChild("MonarchParticles") then
        local p = Instance.new("ParticleEmitter")
        p.Name = "MonarchParticles"
        p.Texture = "rbxassetid://243660364" -- ç…™éœ§æè³ª
        p.Rate = 50
        p.Lifetime = NumberRange.new(0.5, 1)
        p.Speed = NumberRange.new(2)
        p.Size = NumberSequence.new({NumberSequenceKeypoint.new(0, 0.5), NumberSequenceKeypoint.new(1, 0)})
        p.Transparency = NumberSequence.new({NumberSequenceKeypoint.new(0, 0.2), NumberSequenceKeypoint.new(1, 1)})
        p.Rotation = NumberRange.new(0, 360)
        p.RotSpeed = NumberRange.new(-50, 50)
        p.ZOffset = -1
        -- é è¨­é¡è‰²ï¼šæš—å½±ç´«/è—
        p.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 0, 0)),
            ColorSequenceKeypoint.new(0.5, Color3.fromRGB(80, 0, 150)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 150, 255))
        })
        p.Parent = root
    end
end

local function RemoveAura(char)
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart")
    if root and root:FindFirstChild("MonarchParticles") then
        root.MonarchParticles:Destroy()
    end
end

local function AddEyeGlow(char)
    if not char then return end
    local head = char:FindFirstChild("Head")
    if head and not head:FindFirstChild("MonarchEye") then
        local light = Instance.new("PointLight")
        light.Name = "MonarchEye"
        light.Color = Color3.fromRGB(0, 200, 255)
        light.Range = 10
        light.Brightness = 2
        light.Parent = head
        
        -- åŠ å€‹å°å…‰çƒç‰¹æ•ˆ
        local p = Instance.new("ParticleEmitter")
        p.Name = "EyeParticles"
        p.Texture = "rbxassetid://296874871"
        p.Rate = 10
        p.Lifetime = NumberRange.new(0.2, 0.4)
        p.Speed = NumberRange.new(0)
        p.Size = NumberSequence.new(0.5, 0)
        p.Color = ColorSequence.new(Color3.fromRGB(0, 255, 255))
        p.Parent = head
    end
end

local function RemoveEyeGlow(char)
    if not char then return end
    local head = char:FindFirstChild("Head")
    if head then
        if head:FindFirstChild("MonarchEye") then head.MonarchEye:Destroy() end
        if head:FindFirstChild("EyeParticles") then head.EyeParticles:Destroy() end
    end
end

--------------------------------------------------------------------------------
-- 1. UI ä»‹é¢
--------------------------------------------------------------------------------
local Window = Rayfield:CreateWindow({
    Name = "çå¥¶è…³æœ¬ | å›ç‹è¦ºé†’ (Awakening)",
    LoadingTitle = "æ³¨å…¥æš—å½±ä¹‹åŠ›...",
    LoadingSubtitle = "v8.0 æœ€çµ‚æ——è‰¦ç‰ˆ",
    ConfigurationSaving = { Enabled = false },
    KeySystem = false, 
})

local CombatTab = Window:CreateTab("ğŸ’€ çµæ®º", 4483362458)
local FXTab = Window:CreateTab("âœ¨ ç‰¹æ•ˆ", 4483362458) -- [æ–°å¢ç‰¹æ•ˆé ]
local GhostTab = Window:CreateTab("ğŸ‘» éš±èº«", 4483362458)
local VisualTab = Window:CreateTab("ğŸ‘ï¸ è¦–è¦º", 4483362458)
local PlayerTab = Window:CreateTab("âš¡ é«”èƒ½", 4483362458)

--------------------------------------------------------------------------------
-- 2. æˆ°é¬¥ (Combat)
--------------------------------------------------------------------------------
CombatTab:CreateSection("ç›®æ¨™é–å®š")
local TargetInput = CombatTab:CreateInput({
    Name = "è¼¸å…¥ç›®æ¨™åç¨±",
    PlaceholderText = "åå­—æˆ– ID",
    Callback = function(Text)
        Config.TargetName = Text
        local target = FindPlayer(Text)
        if target then
            Config.CurrentTarget = target
            Rayfield:Notify({Title = "é–å®š", Content = "ç›®æ¨™: " .. target.Name, Duration = 3})
        else
            Config.CurrentTarget = nil
            Rayfield:Notify({Title = "éŒ¯èª¤", Content = "æ‰¾ä¸åˆ°ç©å®¶", Duration = 3})
        end
    end,
})

CombatTab:CreateSection("è™•æ±º")
local FlingToggle = CombatTab:CreateToggle({
    Name = "å•Ÿå‹•ï¼šæš´åŠ›ç”©é£› (Fling)",
    CurrentValue = false,
    Callback = function(v)
        Config.FlingEnabled = v
        if v and not Config.CurrentTarget then
            Rayfield:Notify({Title = "è­¦å‘Š", Content = "æœªé–å®šç›®æ¨™", Duration = 3})
            Config.FlingEnabled = false
        end
    end,
})

CombatTab:CreateToggle({Name = "æ“´å¤§åˆ¤å®š (Hitbox)", CurrentValue = false, Callback = function(v) Config.Hitbox = v end})

--------------------------------------------------------------------------------
-- 3. [æ–°å¢] ç‰¹æ•ˆ (FX Tab)
--------------------------------------------------------------------------------
FXTab:CreateSection("å›ç‹è¦–è¦º")

FXTab:CreateToggle({
    Name = "æš—å½±éœ¸æ°£ (Shadow Aura)",
    CurrentValue = false,
    Callback = function(v) 
        Config.Aura = v 
        if v then AddAura(LocalPlayer.Character) else RemoveAura(LocalPlayer.Character) end
    end,
})

FXTab:CreateToggle({
    Name = "å›ç‹ä¹‹çœ¼ (Eye Glow)",
    CurrentValue = false,
    Callback = function(v)
        Config.EyeGlow = v
        if v then AddEyeGlow(LocalPlayer.Character) else RemoveEyeGlow(LocalPlayer.Character) end
    end,
})

FXTab:CreateToggle({
    Name = "æˆ°é¬¥è®Šè‰² (Aggro Mode)",
    CurrentValue = true,
    Callback = function(v) Config.AggroColor = v end,
})

FXTab:CreateLabel("èªªæ˜ï¼šé–‹å•Ÿã€Œæˆ°é¬¥è®Šè‰²ã€å¾Œï¼Œ\nç•¶ä½ æŒ‰ä¸‹ã€Œçµæ®ºã€æ™‚ï¼Œéœ¸æ°£æœƒè‡ªå‹•è®Šç‚ºç´…è‰²ã€‚")

--------------------------------------------------------------------------------
-- 4. éš±èº« (Ghost)
--------------------------------------------------------------------------------
GhostTab:CreateToggle({
    Name = "é–‹å•Ÿéš±å½¢ (Invisible)",
    CurrentValue = false,
    Callback = function(v) 
        Config.Invisible = v 
        if not v and LocalPlayer.Character then
            -- æ¢å¾©å¯è¦‹
            LocalPlayer.Character.Humanoid.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.Viewer
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if (part:IsA("BasePart") or part:IsA("Decal")) and part.Name ~= "HumanoidRootPart" then 
                    part.Transparency = 0 
                end
            end
        end
    end,
})

--------------------------------------------------------------------------------
-- 5. æ‰‹æ©ŸæŒ‰éˆ•
--------------------------------------------------------------------------------
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ZhenNai_FX_UI"
if game.CoreGui:FindFirstChild("ZhenNai_FX_UI") then game.CoreGui.ZhenNai_FX_UI:Destroy() end
ScreenGui.Parent = game.CoreGui

local function CreateBtn(text, pos, color)
    local btn = Instance.new("TextButton")
    btn.Parent = ScreenGui
    btn.Size = UDim2.new(0, 80, 0, 80)
    btn.Position = pos
    btn.BackgroundColor3 = Color3.fromRGB(0,0,0)
    btn.BackgroundTransparency = 0.4
    btn.Text = text
    btn.TextColor3 = color
    btn.Font = Enum.Font.GothamBlack
    btn.TextSize = 16
    Instance.new("UICorner", btn).CornerRadius = UDim.new(1,0)
    Instance.new("UIStroke", btn).Color = color
    Instance.new("UIStroke", btn).Thickness = 2
    btn.Parent.FindFirstChild("UIStroke", true).ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    return btn
end

local HuntBtn = CreateBtn("è™•æ±º", UDim2.new(0.8, 0, 0.45, 0), Color3.fromRGB(255, 0, 0))
local InvisBtn = CreateBtn("éš±å½¢", UDim2.new(0.8, 0, 0.60, 0), Color3.fromRGB(150, 150, 255))

HuntBtn.Visible = false; InvisBtn.Visible = false
CombatTab:CreateToggle({Name = "æ‰‹æ©ŸæŒ‰éˆ•", CurrentValue = false, Callback = function(v) HuntBtn.Visible = v InvisBtn.Visible = v end})

HuntBtn.MouseButton1Click:Connect(function()
    Config.FlingEnabled = not Config.FlingEnabled
    if Config.FlingEnabled then HuntBtn.Text = "åœæ­¢" else HuntBtn.Text = "è™•æ±º" end
end)

InvisBtn.MouseButton1Click:Connect(function()
    Config.Invisible = not Config.Invisible
    if Config.Invisible then InvisBtn.Text = "ç¾èº«" else InvisBtn.Text = "éš±å½¢" end
end)

--------------------------------------------------------------------------------
-- 6. æ ¸å¿ƒå¾ªç’° & è¦–è¦º & å±¬æ€§
--------------------------------------------------------------------------------
VisualTab:CreateToggle({Name = "ESP", CurrentValue = false, Callback = function(v) Config.ESP = v end})
PlayerTab:CreateSlider({Name = "é€Ÿåº¦", Range = {16, 500}, Increment = 5, CurrentValue = 100, Callback = function(v) Config.Speed = v end})
PlayerTab:CreateToggle({Name = "å•Ÿç”¨é€Ÿåº¦", CurrentValue = false, Callback = function(v) Config.SpeedEnabled = v end})
PlayerTab:CreateToggle({Name = "Noclip", CurrentValue = false, Callback = function(v) Config.Noclip = v end})

RunService.Heartbeat:Connect(function()
    local Char = LocalPlayer.Character
    if not Char or not Char:FindFirstChild("HumanoidRootPart") then return end
    local Root = Char.HumanoidRootPart
    local Humanoid = Char:FindFirstChild("Humanoid")

    -- [ç‰¹æ•ˆå‹•æ…‹è®Šè‰²é‚è¼¯]
    if Config.Aura then
        local particles = Root:FindFirstChild("MonarchParticles")
        if particles then
            if Config.FlingEnabled and Config.AggroColor then
                -- æˆ°é¬¥æ¨¡å¼ï¼šè¡€ç´…éœ¸æ°£
                particles.Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 0, 0)),
                    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 0, 0)),
                    ColorSequenceKeypoint.new(1, Color3.fromRGB(100, 0, 0))
                })
                particles.Rate = 100 -- ç²’å­åŠ å¯†
            else
                -- ä¸€èˆ¬æ¨¡å¼ï¼šæš—å½±è—ç´«
                particles.Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 0, 0)),
                    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(80, 0, 150)),
                    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 150, 255))
                })
                particles.Rate = 50
            end
        else
            AddAura(Char) -- è‹¥æ„å¤–æ¶ˆå¤±å‰‡è£œä¸Š
        end
    end
    
    -- [éš±å½¢é‚è¼¯]
    if Config.Invisible then
        if Humanoid then Humanoid.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None end
        for _, v in pairs(Char:GetDescendants()) do
            if v:IsA("BasePart") and v.Name ~= "HumanoidRootPart" then
                v.Transparency = 1; v.CanCollide = false
            elseif v:IsA("Decal") then
                v.Transparency = 1
            end
        end
    end

    -- [é€Ÿåº¦/ç©¿ç‰†]
    if Config.SpeedEnabled and Humanoid then Humanoid.WalkSpeed = Config.Speed end
    if Config.Noclip or Config.FlingEnabled then
        for _, part in pairs(Char:GetChildren()) do
            if part:IsA("BasePart") then part.CanCollide = false end
        end
    end

    -- [çµæ®ºæ ¸å¿ƒ]
    if Config.FlingEnabled and Config.CurrentTarget then
        local TChar = Config.CurrentTarget.Character
        if TChar and TChar:FindFirstChild("HumanoidRootPart") and TChar.Humanoid.Health > 0 then
            local TRoot = TChar.HumanoidRootPart
            Root.CFrame = TRoot.CFrame * CFrame.new(0, -1, 0)
            Root.AssemblyAngularVelocity = Vector3.new(math.huge, math.huge, math.huge)
            Root.Velocity = Vector3.new(0, 0, 0)
        else
            Config.FlingEnabled = false
            Rayfield:Notify({Title = "ç›®æ¨™æ¸…é™¤", Content = "çµæ®ºçµæŸ", Duration = 2})
            HuntBtn.Text = "è™•æ±º"
            Root.Velocity = Vector3.new(0,0,0); Root.AssemblyAngularVelocity = Vector3.new(0,0,0)
        end
    end
end)

-- [ESP æ¸²æŸ“]
RunService.RenderStepped:Connect(function()
    if Config.ESP then
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") then
                if not p.Character:FindFirstChild("ZhenNaiESP") then
                    local esp = Instance.new("BillboardGui", p.Character.Head)
                    esp.Name = "ZhenNaiESP"; esp.Size = UDim2.new(0, 200, 0, 50); esp.AlwaysOnTop = true
                    local txt = Instance.new("TextLabel", esp); txt.Size = UDim2.new(1,0,1,0); txt.BackgroundTransparency=1
                    txt.TextColor3 = Color3.fromRGB(255, 0, 0); txt.Text = p.Name; txt.TextStrokeTransparency = 0
                end
            end
        end
    else
        for _, p in pairs(Players:GetPlayers()) do
            if p.Character and p.Character:FindFirstChild("ZhenNaiESP") then p.Character.ZhenNaiESP:Destroy() end
        end
    end
    -- Hitbox
    if Config.Hitbox then
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") then
                p.Character.Head.Size = Vector3.new(Config.HitboxSize, Config.HitboxSize, Config.HitboxSize)
                p.Character.Head.Transparency = 0.6; p.Character.Head.CanCollide = false
            end
        end
    end
end)

-- é‡ç”Ÿæ™‚è£œç‰¹æ•ˆ
LocalPlayer.CharacterAdded:Connect(function(newChar)
    task.wait(1)
    if Config.Aura then AddAura(newChar) end
    if Config.EyeGlow then AddEyeGlow(newChar) end
end)

Rayfield:Notify({Title = "å›ç‹è¦ºé†’", Content = "ç‰¹æ•ˆç³»çµ±å·²è£è¼‰ (åˆ†é : ç‰¹æ•ˆ)", Duration = 5})
