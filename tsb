--[[
    çå¥¶è…³æœ¬ (ZhenNai Hub) - æ——è‰¦å®Œå…¨é«” v5.2 (Fling Enhanced)
    é¢¨æ ¼ï¼šç¨è‡ªå‡ç´š (Solo Leveling)
    åŠŸèƒ½ï¼šè‡ªå‹•å‚³é€è²¼èº« + æš´åŠ›ç”©é£›
]]

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

--------------------------------------------------------------------------------
-- 1. ç³»çµ±è¦–çª—èˆ‡æœå‹™
--------------------------------------------------------------------------------
local Window = Rayfield:CreateWindow({
    Name = "çå¥¶è…³æœ¬ | SYSTEM: MONARCH",
    LoadingTitle = "æ­£åœ¨å•Ÿå‹•çµæ®ºæ¨¡å¼...",
    LoadingSubtitle = "ç›®æ¨™é–å®š - å‚³é€ç”©é£›",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "ZhenNai_Monarch",
        FileName = "Config"
    },
    Discord = { Enabled = false },
    KeySystem = false, 
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = game.Workspace.CurrentCamera
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")

-- è…³æœ¬è®Šæ•¸é…ç½®
local Config = {
    -- æˆ°é¬¥
    Aimbot = false, Aiming = false, FOV = 180,
    Hitbox = false, HitboxSize = 7,
    -- çµæ®º (ç”©é£›) æ ¸å¿ƒ
    FlingEnabled = false, 
    FlingPower = 10000, -- å¢å¼·é è¨­åŠ›åº¦
    FlingTarget = nil,  -- ç•¶å‰é–å®šçš„ç›®æ¨™ RootPart
    -- è¦–è¦º
    ESP = false, ShadowTrail = false, Fullbright = false,
    -- è§’è‰²
    Speed = 40, SpeedEnabled = false, InfJump = false, GodMode = false
}

--------------------------------------------------------------------------------
-- 2. æ‰‹æ©Ÿç‰ˆ UI (å½±ä¹‹æ§åˆ¶å°)
--------------------------------------------------------------------------------
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ZhenNai_Mobile_Controls"
if game.CoreGui:FindFirstChild("ZhenNai_Mobile_Controls") then
    game.CoreGui.ZhenNai_Mobile_Controls:Destroy()
end
ScreenGui.Parent = game.CoreGui

local function CreateShadowButton(name, pos, text, color)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Parent = ScreenGui
    btn.Size = UDim2.new(0, 80, 0, 80)
    btn.Position = pos
    btn.BackgroundColor3 = Color3.fromRGB(10, 10, 30)
    btn.BackgroundTransparency = 0.2
    btn.Text = text
    btn.TextColor3 = color
    btn.Font = Enum.Font.GothamBlack
    btn.TextSize = 18
    btn.Visible = false
    
    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(1, 0)
    
    local stroke = Instance.new("UIStroke", btn)
    stroke.Color = color
    stroke.Thickness = 2.5
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    
    return btn, stroke
end

local AimBtn, AimStroke = CreateShadowButton("AimBtn", UDim2.new(0.80, 0, 0.40, 0), "é–å®š", Color3.fromRGB(0, 200, 255))
local HuntBtn, HuntStroke = CreateShadowButton("HuntBtn", UDim2.new(0.80, 0, 0.55, 0), "çµæ®º", Color3.fromRGB(180, 0, 255))

-- [è‡ªç„æŒ‰éˆ•é‚è¼¯]
AimBtn.MouseButton1Down:Connect(function() 
    Config.Aiming = true 
    AimBtn.Text = "ç„æº–ä¸­" 
    AimStroke.Color = Color3.fromRGB(255, 50, 50) 
end)
AimBtn.MouseButton1Up:Connect(function() 
    Config.Aiming = false 
    AimBtn.Text = "é–å®š" 
    AimStroke.Color = Color3.fromRGB(0, 200, 255) 
end)

-- [çµæ®º(ç”©é£›)æŒ‰éˆ•é‚è¼¯] - æŒ‰ä¸‹å³é–å®šæœ€è¿‘äººå‚³é€+ç”©é£›
HuntBtn.MouseButton1Click:Connect(function() 
    Config.FlingEnabled = not Config.FlingEnabled -- åˆ‡æ›é–‹é—œ
    
    if Config.FlingEnabled then
        -- é–‹å•Ÿæ™‚ï¼šå°‹æ‰¾æœ€è¿‘ç›®æ¨™
        local minDist = 99999
        Config.FlingTarget = nil
        
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p.Character:FindFirstChild("Humanoid") and p.Character.Humanoid.Health > 0 then
                local d = (p.Character.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                if d < minDist then
                    minDist = d
                    Config.FlingTarget = p.Character.HumanoidRootPart
                end
            end
        end
        
        if Config.FlingTarget then
            HuntBtn.Text = "è™•æ±ºä¸­"
            HuntStroke.Color = Color3.fromRGB(255, 0, 0)
            Rayfield:Notify({Title = "çµæ®ºé–‹å§‹", Content = "å·²é–å®šç›®æ¨™ï¼Œé–‹å§‹å‚³é€ç”©é£›ï¼", Duration = 2})
        else
            Config.FlingEnabled = false
            Rayfield:Notify({Title = "éŒ¯èª¤", Content = "é™„è¿‘æ²’æœ‰å¯çµæ®ºçš„ç›®æ¨™", Duration = 2})
        end
    else
        -- é—œé–‰æ™‚
        Config.FlingTarget = nil
        HuntBtn.Text = "çµæ®º"
        HuntStroke.Color = Color3.fromRGB(180, 0, 255)
        
        -- é‡ç½®è§’è‰²ç‹€æ…‹é˜²æ­¢å¡ä½
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.Velocity = Vector3.new(0,0,0)
            LocalPlayer.Character.HumanoidRootPart.RotVelocity = Vector3.new(0,0,0)
        end
    end
end)

--------------------------------------------------------------------------------
-- 3. é¸å–®åŠŸèƒ½ (PC/Mobileé€šç”¨)
--------------------------------------------------------------------------------
local CombatTab = Window:CreateTab("ğŸ—¡ï¸ å›ç‹æ¬Šèƒ½", 4483362458)
local VisualTab = Window:CreateTab("ğŸ‘ï¸ å½±å­è¦–è¦º", 4483362458)
local PlayerTab = Window:CreateTab("ğŸƒ ç©å®¶å±¬æ€§", 4483362458)

CombatTab:CreateSection("çµæ®ºæ¨¡å¼ (Teleport Fling)")
CombatTab:CreateToggle({
    Name = "é¡¯ç¤ºçµæ®ºæŒ‰éˆ• (æ‰‹æ©ŸUI)",
    CurrentValue = false,
    Callback = function(v) HuntBtn.Visible = v end,
})
CombatTab:CreateLabel("é›»è…¦ç‰ˆç›´æ¥åœ¨ä¸‹æ–¹é–‹é—œï¼š")
CombatTab:CreateToggle({
    Name = "å•Ÿç”¨ç”©é£› (è‡ªå‹•é–å®šæœ€è¿‘)",
    CurrentValue = false,
    Callback = function(v) 
        -- è§¸ç™¼æŒ‰éˆ•çš„é‚è¼¯
        if v ~= Config.FlingEnabled then
            for _, conn in pairs(getconnections(HuntBtn.MouseButton1Click)) do
                conn:Fire()
            end
        end
    end,
})

CombatTab:CreateSection("æˆ°é¬¥è¼”åŠ©")
CombatTab:CreateToggle({
    Name = "é¡¯ç¤ºè‡ªç„æŒ‰éˆ• (æ‰‹æ©ŸUI)",
    CurrentValue = false,
    Callback = function(v) AimBtn.Visible = v end,
})
CombatTab:CreateToggle({
    Name = "å½±ä¹‹æå– (å¤§é ­åˆ¤å®š Hitbox)",
    CurrentValue = false,
    Callback = function(v) Config.Hitbox = v end,
})

VisualTab:CreateSection("è¦–è¦º")
VisualTab:CreateToggle({
    Name = "ESP (é€è¦–)",
    CurrentValue = false,
    Callback = function(v) Config.ESP = v end,
})
VisualTab:CreateToggle({
    Name = "å›ç‹æ®˜å½± (Trail)",
    CurrentValue = false,
    Callback = function(v) Config.ShadowTrail = v end,
})

PlayerTab:CreateSection("ç§»å‹•")
PlayerTab:CreateSlider({
    Name = "ç§»å‹•é€Ÿåº¦",
    Range = {16, 300}, Increment = 5, CurrentValue = 40,
    Callback = function(v) Config.Speed = v end,
})
PlayerTab:CreateToggle({
    Name = "å•Ÿç”¨é€Ÿåº¦ä¿®æ”¹",
    CurrentValue = false,
    Callback = function(v) Config.SpeedEnabled = v end,
})
PlayerTab:CreateToggle({
    Name = "å½ç„¡æ•µ (God Mode)",
    CurrentValue = false,
    Callback = function(v) Config.GodMode = v end,
})

--------------------------------------------------------------------------------
-- 4. æ ¸å¿ƒå¾ªç’°é‚è¼¯ (Core Loop)
--------------------------------------------------------------------------------

RunService.Heartbeat:Connect(function()
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then return end
    
    local Root = LocalPlayer.Character.HumanoidRootPart
    local Humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")

    -- [é€Ÿåº¦æ§åˆ¶]
    if Config.SpeedEnabled and Humanoid then 
        Humanoid.WalkSpeed = Config.Speed 
    end
    
    -- [ç„¡æ•µæ§åˆ¶]
    if Config.GodMode and Humanoid then
        Humanoid.Health = Humanoid.MaxHealth
    end

    -- [æš´åŠ›ç”©é£›é‚è¼¯ - é‡é»å„ªåŒ–]
    if Config.FlingEnabled then
        -- æª¢æŸ¥ç›®æ¨™æ˜¯å¦å­˜æ´»
        if Config.FlingTarget and Config.FlingTarget.Parent and Config.FlingTarget.Parent:FindFirstChild("Humanoid") and Config.FlingTarget.Parent.Humanoid.Health > 0 then
            
            -- 1. è§£é™¤è‡ªèº«ç¢°æ’ (Noclip) ä»¥ä¾¿ç©¿éç‰†å£å’Œé€²å…¥ç›®æ¨™é«”å…§
            for _, part in pairs(LocalPlayer.Character:GetChildren()) do
                if part:IsA("BasePart") then 
                    part.CanCollide = false 
                    part.Velocity = Vector3.new(0, 0, 0) -- é‡ç½®ç·šæ€§é€Ÿåº¦é˜²æ­¢äº‚é£›
                end
            end
            
            -- 2. å‚³é€é‚è¼¯ (Teleport)
            -- å°‡è‡ªå·±æŒçºŒå‚³é€åˆ°ç›®æ¨™çš„ä½ç½® (ç¨å¾®åŠ ä¸€é»åç§»ç¢ºä¿é‡ç–Š)
            local targetPos = Config.FlingTarget.Position
            local targetVel = Config.FlingTarget.Velocity
            
            -- CFrame é–å®šï¼šç·Šè²¼ç›®æ¨™
            Root.CFrame = CFrame.new(targetPos) * CFrame.new(0, 0, 0) 
            
            -- 3. æ—‹è½‰ç‰©ç† (Fling Physics)
            -- è¨­å®šæ¥µé«˜çš„æ—‹è½‰é€Ÿåº¦ï¼Œé€™æ˜¯é€ æˆå°æ–¹è¢«ç‰©ç†å¼•æ“å½ˆé£›çš„ä¸»å› 
            Root.RotVelocity = Vector3.new(9000, 9000, 9000)
            
            -- ä¿æŒ Y è»¸é€Ÿåº¦ç‚º 0 æˆ–å‘ä¸Šï¼Œé¿å…æ‰è½è™›ç©º
            Root.Velocity = Vector3.new(0, 0, 0) 
            
        else
            -- å¦‚æœç›®æ¨™æ­»äº¡æˆ–æ¶ˆå¤±ï¼Œè‡ªå‹•é—œé–‰
            Config.FlingEnabled = false
            Config.FlingTarget = nil
            HuntBtn.Text = "çµæ®º"
            HuntStroke.Color = Color3.fromRGB(180, 0, 255)
            Rayfield:Notify({Title = "çµæŸ", Content = "ç›®æ¨™å·²æ¸…é™¤æˆ–ä¸Ÿå¤±", Duration = 2})
            
            -- ç…è»Š
            Root.Velocity = Vector3.new(0,0,0)
            Root.RotVelocity = Vector3.new(0,0,0)
        end
    end
end)

-- [è¦–è¦ºç‰¹æ•ˆèˆ‡è‡ªç„ RenderStepped]
RunService.RenderStepped:Connect(function()
    -- è‡ªç„
    if Config.Aiming and Config.Aimbot == false then -- ç°¡å–®è™•ç†ï¼Œç•¶æŒ‰ä½æŒ‰éˆ•æ™‚å¼·åˆ¶é–‹å•Ÿé‚è¼¯
        local target = nil
        local dist = 300
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") then
                local pos, vis = Camera:WorldToViewportPoint(p.Character.Head.Position)
                if vis then
                    local mag = (Vector2.new(pos.X, pos.Y) - Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)).Magnitude
                    if mag < dist then target = p.Character.Head dist = mag end
                end
            end
        end
        if target then
            TweenService:Create(Camera, TweenInfo.new(0.05, Enum.EasingStyle.Sine), {CFrame = CFrame.new(Camera.CFrame.Position, target.Position)}):Play()
        end
    end
    
    -- ESP
    if Config.ESP then
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                if not p.Character:FindFirstChild("HighlightESP") then
                    local h = Instance.new("Highlight", p.Character)
                    h.Name = "HighlightESP"
                    h.FillColor = Color3.fromRGB(100, 0, 255)
                    h.OutlineColor = Color3.fromRGB(255, 255, 255)
                end
            end
        end
    else
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("HighlightESP") then
                p.Character.HighlightESP:Destroy()
            end
        end
    end
    
    -- Hitbox
    if Config.Hitbox then
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") then
                p.Character.Head.Size = Vector3.new(Config.HitboxSize, Config.HitboxSize, Config.HitboxSize)
                p.Character.Head.Transparency = 0.7
                p.Character.Head.CanCollide = false
            end
        end
    end
end)

-- [ç„¡é™è·³èº]
UserInputService.JumpRequest:Connect(function()
    if Config.InfJump and LocalPlayer.Character then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end
end)

Rayfield:Notify({
    Title = "ç³»çµ±ï¼šå›ç‹é™è‡¨",
    Content = "è…³æœ¬è¼‰å…¥å®Œæˆã€‚ä½¿ç”¨ [çµæ®º] æŒ‰éˆ•é–‹å§‹å‚³é€ç”©é£›ã€‚",
    Duration = 5,
})
